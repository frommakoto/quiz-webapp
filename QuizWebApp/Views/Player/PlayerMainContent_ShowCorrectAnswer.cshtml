@model QuizWebApp.Models.PlayCode2013QuizDB
@using QuizWebApp.Models
@using QuizWebApp.Helpers

@{
    var q = Model.Questions.Find(Model.Contexts.First().CurrentQuestionID);
    var playerID = Model.Players.First(p => p.Name == User.Identity.Name).PlayerID;
    var yourAns = Model.Answers.First(a => a.PlayerID == playerID && a.QuestionID == q.QuestionId);
    var choosed = yourAns.ChoosedOptionIndex >= 0 ? q.GetOptions()[yourAns.ChoosedOptionIndex - 1] : null;
    var correctOption = q.GetOptions()[q.IndexOfCorrectOption - 1];
}

<div class="well well-small">
    <h3>Question is...</h3>
    <div>
        @Html.FormatToHtml(q.Body, q.BodyFormat)
    </div>
</div>

<div class="well well-small">
    <h3>Your Choice is...</h3>

    <div class="options">
        @if (choosed == null)
        {
            <p>no choice.</p>
        }
        else
        {
            <div>@(choosed.Option)</div>
            if (string.IsNullOrEmpty(choosed.OptionImage) == false)
            {
                <img src="@choosed.OptionImage" />
            }
        }
    </div>

    @if (yourAns.Status == AnswerStateType.Correct)
    {
        <h3 class="correct">Correct!</h3>
    }
    else
    {
        <h3 class="incorrect">Incorrect...</h3>

        <h4>Correct is:</h4>
        <div class="options">
            <div>@correctOption.Option</div>
            @if (string.IsNullOrEmpty(correctOption.OptionImage) == false)
            {
                <img src="@correctOption.OptionImage" />
            }
        </div>
    }
</div>

<div class="well well-small">
    @if (string.IsNullOrEmpty(q.Comment) == false)
    {
        <h3>Details...</h3>

        <div>@Html.FormatToHtml(q.Comment, q.CommentFormat)</div>
    }
</div>